<div class="page-wrapper">
  <div class="app-card">
    <div class="flex items-center justify-between gap-3 mb-4">
      <h2 class="section-title mb-0">Postulantes seleccionados para informe</h2>
      <button type="button" class="btn btn-outline" (click)="cargarPostulantes()" [disabled]="cargando()">
        {{ cargando() ? 'Actualizando…' : 'Actualizar' }}
      </button>
    </div>

    <div *ngIf="error()" class="alert error mb-4">
      {{ error() }}
    </div>

    <div *ngIf="cargando()" class="text-gray-500">Cargando postulantes...</div>

    <ng-container *ngIf="!cargando()">
      <div *ngIf="!error() && postulantes().length === 0" class="text-gray-500">
        No hay postulantes marcados para informe en este momento.
      </div>

      <table *ngIf="postulantes().length > 0" class="table">
        <thead>
          <tr>
            <th>Postulante</th>
            <th>Puesto solicitado</th>
            <th>Vacante</th>
            <th>Ciudad</th>
            <th>Estado</th>
            <th class="text-right">Acciones</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of postulantes(); trackBy: trackByAsignacion">
            <td>{{ item.postulante?.nombreCompleto || 'Sin nombre' }}</td>
            <td>{{ item.postulante?.puestoSolicita || 'Sin dato' }}</td>
            <td>{{ item.vacante?.puesto || 'Vacante sin titulo' }}</td>
            <td>{{ item.vacante?.ciudad || 'No definida' }}</td>
            <td>
              <span class="estado-pill" [ngClass]="item.estadoAsignacion">
                {{ item.estadoAsignacion | titlecase }}
              </span>
            </td>
            <td class="text-right">
              <button type="button" class="btn btn-primary btn-sm" (click)="irAGestionInformes(item)">
                Generar informe
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </ng-container>
  </div>
</div>
